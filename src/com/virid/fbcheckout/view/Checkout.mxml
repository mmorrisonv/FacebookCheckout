<?xml version="1.0" encoding="utf-8"?>
<s:Group xmlns:fx="http://ns.adobe.com/mxml/2009" 
		 xmlns:s="library://ns.adobe.com/flex/spark" 
		 xmlns:mx="library://ns.adobe.com/flex/mx" width="154" height="100%" xmlns:smallviews="com.virid.fbcheckout.view.smallviews.*"
		 creationComplete="creationComplete(event)" xmlns:view="com.virid.fbcheckout.view.*">
	<fx:Script>
		<![CDATA[
			import com.adobe.serialization.json.JSON;
			
			import controller.commands.checkoutArbiter;
			
			import mx.events.FlexEvent;
			import mx.rpc.events.FaultEvent;
			import mx.rpc.events.ResultEvent;
			import mx.rpc.http.HTTPService;
			
			import spark.events.IndexChangeEvent;
			import spark.events.TextOperationEvent;
			
			/*
			*Event Definition
			*/
			static var BILLING_SAME_AS:String="BSA";
			static var CHECKOUT_PURCHASE:String = "FINAL_PURCHASE"
			

			protected function ratingChanged(event:IndexChangeEvent):void
			{
				// TODO Auto-generated method stub
				
			}
			
			protected function creationComplete(event:FlexEvent):void
			{
				var myMediator:CheckoutMediator = new CheckoutMediator();
				myMediator.register(this);
				if(this.sameAsShipping.selected)
					deactivateAllBillingFields();
				else
					enableAllBillingFields();
				
				//setup demo info
				bfname.text = "Toby";
				sfname.text = "Toby";
				blname.text = "Johnson"; 
				slname.text = "Johnson";
				baddress1.text = "555 Alexander Bell Dr.";
				saddress1.text = "555 Alexander Bell Dr.";
				baddress2.text = ""
				saddress2.text = "";
				bstate.text  = "VA";
				sstate.text = "VA";
				bzip.text = "44444"
				szip.text = "44444";
				bcity.text = "reston";
				scity.text = "reston";
				
				email.text = "mail@virid.com";
				phonenum.text = "5555555555";

				this.bcardnum.text ="4111-1111-1111-1111";
				this.bcardcvv.text = "123";
				bcardmonth.text = "4";
				bcardyear.text = "2012";
				
			}
			
			
			protected function checkoutClicked(event:MouseEvent):void
			{
				//build an address from form inputs
			
				//show the status modal
				var e:Event = new Event(CHECKOUT_PURCHASE);
				dispatchEvent(e);
				
			}


			
			protected function sfname_changeHandler(event:TextOperationEvent):void
			{
				if(this.sameAsShipping.selected)
					this.bfname.text = this.sfname.text;
			}
			
			protected function checkbox1_changeHandler(event:Event):void
			{
				var e:Event = new Event(BILLING_SAME_AS);
				dispatchEvent(e);
				if( this.sameAsShipping.selected )
					deactivateAllBillingFields();
				else
					enableAllBillingFields();
			}
			
			private function deactivateAllBillingFields():void
			{
				// TODO Auto Generated method stub
				this.baddress1.enabled = this.baddress2.enabled = this.bfname.enabled = this.blname.enabled = this.bstate.enabled = this.bcity.enabled = this.bzip.enabled = this.bcity.enabled = false;
				this.bfname.text = this.sfname.text;
				this.blname.text = this.slname.text;
				this.baddress1.text = this.saddress1.text;
				this.baddress2.text = this.saddress2.text;
				this.bstate.text = this.sstate.text;
				this.bzip.text = this.szip.text;
				this.bcity.text = this.scity.text;
			}
			private function enableAllBillingFields():void
			{
				// TODO Auto Generated method stub
				this.baddress1.enabled = this.baddress2.enabled = this.bfname.enabled = this.blname.enabled = this.bstate.enabled = this.bcity.enabled = this.bzip.enabled = this.bcity.enabled = true;

			}
			
			protected function slname_changeHandler(event:TextOperationEvent):void
			{
				if(this.sameAsShipping.selected)
					this.blname.text = this.slname.text;
				
			}
			
			protected function saddress1_changeHandler(event:TextOperationEvent):void
			{
				if(this.sameAsShipping.selected)
					this.baddress1.text = this.saddress1.text;
			}
			
			protected function saddress2_changeHandler(event:TextOperationEvent):void
			{
				if(this.sameAsShipping.selected)
					this.baddress2.text = this.saddress2.text;
			}
			
			protected function sstate_changeHandler(event:TextOperationEvent):void
			{
				if(this.sameAsShipping.selected)
					this.bstate.text = this.sstate.text;
				
			}
			
			protected function szip_changeHandler(event:TextOperationEvent):void
			{
				if(this.sameAsShipping.selected)
					this.bzip.text = this.szip.text;
				
			}
			
			protected function scity_changeHandler(event:TextOperationEvent):void
			{
				if(this.sameAsShipping.selected)
					this.bcity.text = this.scity.text;
				
			}
			

			
		]]>
	</fx:Script>
	<fx:Declarations>
		<!-- Place non-visual elements (e.g., services, value objects) here -->
		<s:Power id="bigThing"/>
		<s:Animate id="animateToProdDetail" target="{this}" duration="700" easer="{bigThing}">
			<s:SimpleMotionPath  property="y" valueTo="1000"/>
		</s:Animate>
	</fx:Declarations>
	
	<s:Rect width="100%" height="100%">
		<s:fill>
			<s:SolidColor color="0xcccccc"/>
		</s:fill>
	</s:Rect>

	<s:HGroup width="100%" paddingTop="3" paddingRight="3" paddingBottom="3" paddingLeft="3">
		<s:VGroup width="50%" height="100%" paddingTop="3" paddingRight="3" paddingBottom="3" paddingLeft="3"
				  gap="3">
			
			<s:Label styleName="lubalin" text="Shipping Address" fontSize="14" height="14"/>
			<s:HGroup width="100%">
				<s:TextInput id="sfname" prompt="First Name" width="100%" change="sfname_changeHandler(event)"/>
				<s:TextInput id="slname" prompt="Last Name" width="100%" change="slname_changeHandler(event)"/>
			</s:HGroup>
			<s:TextInput id="saddress1" prompt="Address 1" width="100%" change="saddress1_changeHandler(event)"/>
			<s:TextInput id="saddress2" prompt="Address 2" width="100%" change="saddress2_changeHandler(event)"/>
			<s:HGroup width="100%">
				<s:TextInput id="scity" prompt="City" width="60%" change="scity_changeHandler(event)"/>
				<s:TextInput id="sstate" prompt="ST" width="18%" maxChars="2" change="sstate_changeHandler(event)"/>
				<s:TextInput id="szip" prompt="Zip" width="22%" maxChars="5" change="szip_changeHandler(event)"/>
			</s:HGroup>		
			<s:TextInput id="email" prompt="Email Address for receipt" width="100%"/>
			
			
			<s:Label styleName="lubalin" text="Shipping Method" fontSize="14" height="14" paddingTop="2" />
			<s:DropDownList id="soptions" width="100%" contentBackgroundColor="0xaaaaaa" borderAlpha="0" borderVisible="false" skinClass="com.virid.fbcheckout.view.smallviews.skins.DropDownSkin" cornerRadius="0" verticalCenter="-1" >
				<s:ArrayCollection>
					<fx:String>Enter Zip Code for Options</fx:String>
				</s:ArrayCollection>
			</s:DropDownList>
		</s:VGroup>
		<s:VGroup width="50%" height="100%" gap="3"
				  paddingTop="3" paddingRight="3" paddingBottom="3" paddingLeft="3">
			<s:Group height="14">
				<s:Label styleName="lubalin" text="Billing Info" fontSize="14" height="14"/>
				<s:CheckBox id="sameAsShipping" styleName="lubalin" label="Same As Shipping" fontSize="10" color="0xffffff" selected="true" x="90" y="-3" alignmentBaseline="ideographicCenter" change="checkbox1_changeHandler(event)"/>
			</s:Group>
			<s:HGroup width="100%">
				<s:TextInput id="bfname" prompt="First Name" width="100%"/>
				<s:TextInput id="blname" prompt="Last Name" width="100%"/>
			</s:HGroup>
			<s:TextInput id="baddress1" prompt="Address 1" width="100%"/>
			<s:TextInput id="baddress2" prompt="Address 2" width="100%"/>
			<s:HGroup width="100%">
				<s:TextInput id="bcity" prompt="City" width="60%"/>
				<s:TextInput id="bstate" prompt="ST" width="18%" maxChars="2"/>
				<s:TextInput id="bzip" prompt="Zip" width="22%" maxChars="5"/>
			</s:HGroup>	
			<s:TextInput id="phonenum" prompt="Phone Number" width="100%"/>
			<s:Label styleName="lubalin" text="Card Details" fontSize="14" height="14" paddingTop="2"/>
			<s:HGroup width="100%">
				<s:TextInput id="bcardnum" prompt="Card Number" width="50%"/>
				<s:TextInput id="bcardmonth" prompt="MM" width="15%" maxChars="2"/>
				<s:TextInput id="bcardyear" prompt="YYYY" width="20%" maxChars="4"/>
				<s:TextInput id="bcardcvv" prompt="CVV" width="15%" maxChars="3"/>
			</s:HGroup>	
		</s:VGroup>
	</s:HGroup>

	<s:Group width="100%" height="40" y="165">
		<s:Rect width="100%" height="100%">
			<s:fill>
				<s:SolidColor color="0xffffff" />
			</s:fill>
		</s:Rect>
		<s:Image source="assets/checkout-bottom-wedge.png" width="243" height="10" bottom="0"/>
		<s:Group width="100%" height="36">
			<s:Group height="36" left="10">
				<s:Label text="Final Price:" fontSize="11" styleName="lubalin" verticalCenter="0"/>
				<s:Label id="cartPrice" text="$--.-- USD" x="60" fontSize="18" styleName="lubalin" verticalCenter="0"/>
			</s:Group>
			<s:Group width="56" height="22" left="175" y="3">
				<s:Rect width="100%" height="100%"><s:stroke><s:SolidColorStroke color="0xcccccc" weight="1" /></s:stroke></s:Rect>
				<s:Label text="ITEMIZED&#13;VIEW" fontSize="9" color="0xcccccc" verticalCenter="1" horizontalCenter="0" textAlign="center" lineHeight="10"/>
			</s:Group>
			
			<s:Group right="0" width="161" height="40" 
					 click="checkoutClicked(event)" buttonMode="true" useHandCursor="true">
				<s:Image id="checkoutBtn" source="assets/buttons/checkout-complete.png" width="161" height="31" right="0" verticalCenter="-2"/>
				<s:Label text="Complete Purchase" styleName="lubalin" color="0xffffff" fontSize="16" horizontalCenter="0" verticalCenter="-2"/>
			</s:Group>
			
		</s:Group>
		
	</s:Group>

</s:Group>
